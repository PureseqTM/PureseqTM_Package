#=================
# running example:
#=================

#---------- Part 1: single protein prediction -----------#
#-> prediction without ground-truth label
./PureseqTM.sh -i example/4j7cK.fasta

#-> given ground-truth 2-state TM label
./PureseqTM.sh -i example/4j7cK.fasta -l example/4j7cK.top

#-> plot the posterior probabilities using GNUPLOT
./PureseqTM.sh -i example/4j7cK.fasta -P 1

#------ evaluate the prediction result, if the ground-truth label is provided ---------#
grep -v "#" 4j7cK_PureTM/4j7cK.prob | awk '{print $NF" "$3}' > 4j7cK.pred_reso
util/TM2_Evaluation 4j7cK.pred_reso 0.5
rm -f 4j7cK.pred_reso

#-> prediction with given profile
./PureseqTM.sh -i example/1bhaA.tgt


#---------- Part 2: proteome prediction -----------------#
#-> a toy example
./PureseqTM_proteome.sh -i example/test_proteome.fasta

#-> a real-world example
#./PureseqTM_proteome.sh -i example/human_20416.fasta


#---------- Part 3: output files ------------------------#
# there shall be 5 output files in XXX_PureTM by default, where XXX is the input name:
# 1) XXX.fasta_raw   :  original input sequence file in FASTA format
# 2) XXX.fasta       :  canonical sequence file without non-canonical characters
# 3) XXX.top         :  simple 2-state TransMembrane (TM) prediction in one-line label
# 4) XXX.prob        :  detailed 2-state TransMembrane (TM) profile prediction
# 5) XXX.pred_mode   :  prediction mode (0 for sequence and 1 for profile)
# 6) XXX.png         :  posterior probabilities ploted by GNUPLOT (if option -P 1 is set)
# 7) XXX.gff         :  segment-level output for the server (if option -P 1 is set)


#---------- Part 4: generate sequence profile -----------#
# Users are suggested to use the TGT_Package to generate the sequence profile in TGT format:
#     https://github.com/realbigws/TGT_Package
# by typing the followring command:
#     ./A3M_TGT_Gen.sh -i <input_fasta> -d uniprot20_2016_02 -h hhsuite2 -n 3 -E 10


#---------- Part 5: transfer PDBTM label to 0/1 label ---#
python util/pdbtm2binary.py example/1bhaA.pdbtm


#===================== References =======================#
#-> 1. Phobius
# Title:
#     A Combined Transmembrane Topology and Signal Peptide Prediction Method
# Authors:
#     Lukas Kall, Anders Krogh and Erik L. L. Sonnhammer
# Journal:
#     J. Mol. Biol. (2004) 338, 1027â€“1036
#--------------------------------------------------------#
#-> 2. Philius
# Title:
#     Transmembrane Topology and Signal Peptide Prediction Using Dynamic Bayesian Networks
# Authors:
#     Sheila M. Reynolds, Lukas Kall, Michael E. Riffle, Jeff A. Bilmes, William Stafford Noble
# Journal:
#     PLoS computational biology (2008) 4(11):e1000213
#--------------------------------------------------------#
#-> 3. DeeppCNF
# Title:
#     Protein secondary structure prediction using deep convolutional neural fields
# Authors:
#     Sheng Wang, Jian Peng, Jianzhu Ma, Jinbo Xu
# Journal:
#     Scientific reports (2016) 6:18962
#========================================================#


